{
    "contents" : "analyze<-function(){library(shiny)\n  library(dplyr)\n  library(ggplot2)\n  library(datasets)\n  \n  dat <- read.csv(\"/Users/gimyejin/Desktop/chart.csv\", header=T,stringsAsFactors = F)\n  experimental<-filter(dat, char==\"experimental\")\n  experimental.50<-filter(experimental, age<60)\n  experimental.60<-filter(experimental, age>=60, age<70)\n  experimental.70<-filter(experimental, age>=70, age<80)\n  experimental.over<-filter(experimental, age>=80)\n  comparison<-filter(dat, char==\"comparison\")\n  comparison.50<-filter(comparison, age<60)\n  comparison.60<-filter(comparison, age>=60, age<70)\n  comparison.70<-filter(comparison, age>=70, age<80)\n  comparison.over<-filter(comparison, age>=80)\n  \n  \n  aver.ex.50<-summarise(experimental.50, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.ex.60<-summarise(experimental.60, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.ex.70<-summarise(experimental.70, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.ex.over<-summarise(experimental.over, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  \n  \n  aver.cp.50<-summarise(comparison.50, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.cp.60<-summarise(comparison.60, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.cp.70<-summarise(comparison.70, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  aver.cp.over<-summarise(comparison.over, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n  \n  age<-c(50, 60, 70, 80)\n  aver.cp<-rbind(aver.cp.50,aver.cp.60,aver.cp.70,aver.cp.over)\n  aver.cp$age<-age\n  \n  aver.ex<-rbind(aver.ex.50,aver.ex.60,aver.ex.70,aver.ex.over)\n  aver.ex$age<-age\n  \n  char<-c(\"comparison\", \"comparison\", \"comparison\", \"comparison\")\n  aver.cp$char<-char\n  char<-c(\"experimental\", \"experimental\",\"experimental\",\"experimental\")\n  aver.ex$char<-char\n  total<-rbind(aver.cp, aver.ex)\n  diff.st<-total$aver_af.st-total$aver_bf.st\n  diff.eq5d<-total$aver_af.eq-total$aver_bf.eq\n  diff.mr<-total$aver_af.mr-total$aver_bf.mr\n  total$diff.st<-diff.st\n  total$diff.eq<-diff.eq5d\n  total$diff.mr<-diff.mr\n  \n  experimental<-filter(dat, char==\"experimental\")\n  monthly<-summarise(experimental, month1=mean(m1),month2=mean(m2),month3=mean(m3),month4=mean(m4),month5=mean(m5),month6=mean(m6),month7=mean(m7),month8=mean(m8),month9=mean(m9),month10=mean(m10),month11=mean(m11),month12=mean(m12))\n  \n  server<-function(input, output){\n    output$plot <- renderPlot({\n      #op<-par(no.readonly=TRUE)\n      \n      #par(mfrow=c(2,2))\n      \n      if(input$x == \"age\")\n      {\n        experimental<-filter(dat, char==\"experimental\")\n        experimental.50<-filter(experimental, age<60)\n        experimental.60<-filter(experimental, age>=60, age<70)\n        experimental.70<-filter(experimental, age>=70, age<80)\n        experimental.over<-filter(experimental, age>=80)\n        comparison<-filter(dat, char==\"comparison\")\n        comparison.50<-filter(comparison, age<60)\n        comparison.60<-filter(comparison, age>=60, age<70)\n        comparison.70<-filter(comparison, age>=70, age<80)\n        comparison.over<-filter(comparison, age>=80)\n        \n        \n        aver.ex.50<-summarise(experimental.50, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.ex.60<-summarise(experimental.60, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.ex.70<-summarise(experimental.70, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.ex.over<-summarise(experimental.over, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        \n        \n        aver.cp.50<-summarise(comparison.50, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.cp.60<-summarise(comparison.60, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.cp.70<-summarise(comparison.70, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.cp.over<-summarise(comparison.over, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        \n        age<-c(50, 60, 70, 80)\n        aver.cp<-rbind(aver.cp.50,aver.cp.60,aver.cp.70,aver.cp.over)\n        aver.cp$age<-age\n        \n        aver.ex<-rbind(aver.ex.50,aver.ex.60,aver.ex.70,aver.ex.over)\n        aver.ex$age<-age\n        \n        char<-c(\"comparison\", \"comparison\", \"comparison\", \"comparison\")\n        aver.cp$char<-char\n        char<-c(\"experimental\", \"experimental\",\"experimental\",\"experimental\")\n        aver.ex$char<-char\n        total<-rbind(aver.cp, aver.ex)\n        diff.st<-total$aver_af.st-total$aver_bf.st\n        diff.eq5d<-total$aver_af.eq-total$aver_bf.eq\n        diff.mr<-total$aver_af.mr-total$aver_bf.mr\n        total$diff.st<-diff.st\n        total$diff.eq<-diff.eq5d\n        total$diff.mr<-diff.mr\n        \n        p<- ggplot(total, aes_string(input$x, input$y)) + geom_bar(width=3, stat=\"identity\", position=\"dodge\")+theme_bw()\n        \n        if(input$color != \"None\")\n        {p<-p+aes_string(fill=input$color)}\n        \n        print(p)\n      }\n      else{\n        experimental<-filter(dat, char==\"experimental\")\n        experimental.a<-filter(experimental, illness==\"A\") #질병1\n        experimental.b<-filter(experimental, illness==\"B\") #질병2\n        experimental.c<-filter(experimental, illness==\"C\") #질병3\n        comparison<-filter(dat, char==\"comparison\")\n        comparison.a<-filter(comparison, illness==\"A\") #질병1\n        comparison.b<-filter(comparison, illness==\"B\") #질병2\n        comparison.c<-filter(comparison, illness==\"C\") #질병3\n        \n        aver.ex.a<-summarise(experimental.a, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), \t\taver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.ex.b<-summarise(experimental.b, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.ex.c<-summarise(experimental.c, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        \n        aver.cp.a<-summarise(comparison.a, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.cp.b<-summarise(comparison.b, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        aver.cp.c<-summarise(comparison.c, aver_bf.eq=mean(bf.eq5d), aver_bf.gh=mean(bf.gh), aver_bf.mr=mean(bf.mr), aver_bf.vt=mean(bf.vt), aver_bf.st=mean(bf.strides), aver_af.eq=mean(af.eq5d), aver_af.gh=mean(af.gh), aver_af.mr=mean(af.mr), aver_af.vt=mean(af.vt), aver_af.st=mean(af.strides))\n        \n        \n        aver.cp<-rbind(aver.cp.a,aver.cp.b,aver.cp.c)\n        aver.cp$illness<-c(\"A\",\"B\",\"C\")\n        aver.cp\n        aver.ex<-rbind(aver.ex.a,aver.ex.b,aver.ex.c)\n        aver.ex$illness<-c(\"A\",\"B\",\"C\")\n        \n        char<-c(\"comparison\", \"comparison\", \"comparison\")\n        aver.cp$char<-char\n        char<-c(\"experimental\", \"experimental\",\"experimental\")\n        aver.ex$char<-char\n        total<-rbind(aver.cp, aver.ex)\n        \n        diff.st<-total$aver_af.st-total$aver_bf.st\n        diff.eq5d<-total$aver_af.eq-total$aver_bf.eq\n        diff.mr<-total$aver_af.mr-total$aver_bf.mr\n        total$diff.st<-diff.st\n        total$diff.eq<-diff.eq5d\n        total$diff.mr<-diff.mr\n        \n        p<- ggplot(total, aes_string(x=input$x, y=input$y)) + geom_bar(width=.3, stat=\"identity\", position=\"dodge\") + theme_bw()\n        if(input$color != \"None\")\n        {p<-p+aes_string(fill=input$color) }\n        \n        print(p)\n      }})\n    \n    #기간별 평균 걸음수 비교\n    output$plot2 <- renderPlot({\n      experimental<-filter(dat, char==\"experimental\")\n      monthly<-summarise(experimental, month1=mean(m1),month2=mean(m2),month3=mean(m3),month4=mean(m4),month5=mean(m5),month6=mean(m6),month7=mean(m7),month8=mean(m8),month9=mean(m9),month10=mean(m10),month11=mean(m11),month12=mean(m12))\n      month<-c(input$month1, input$month2)\n      stride<-c(monthly[,input$month1], monthly[,input$month2])\n      mont<-data.frame(month,stride)\n      h<-ggplot(mont, aes(x=month, y=stride)) + geom_bar(stat=\"identity\", postiion=\"dodge\", fill=\"light steel blue\", width=0.1)+theme_bw()\n      print(h)\n    })\n    \n    output$plot3 <- renderPlot({\n      if(input$names!=\"None\")\n      {\n      experimental<-filter(dat, char==\"experimental\")\n      people<-filter(experimental,name==input$names)\n      persons<-summarise(people, month1=mean(m1),month2=mean(m2),month3=mean(m3),month4=mean(m4),month5=mean(m5),month6=mean(m6),month7=mean(m7),month8=mean(m8),month9=mean(m9),month10=mean(m10),month11=mean(m11),month12=mean(m12))\n      month<-c(input$month3, input$month4)\n      stride<-c(persons[,input$month3], persons[,input$month4])\n      mont<-data.frame(month,stride)\n      k<-ggplot(mont, aes(x=month, y=stride)) + geom_bar(stat=\"identity\", positiion=\"dodge\", fill=\"light steel blue\", width=0.1)+theme_bw()\n      print(k)\n      }\n    })\n    \n    \n    \n  }\n  \n  ui<-navbarPage(\"환자분석툴\",\n                 tabPanel(\"종합\",\n                          pageWithSidebar\n                          (\n                          headerPanel(\"실험군 대조군 비교\"),\n                          \n                          sidebarPanel(\n                            selectInput(\"x\", \"Please Select x-axix\", choices=c(\"age\", \"illness\")),\n                            selectInput(\"y\", \"indexes\", choices=colnames(total)),\n                            selectInput(\"color\", \"Seperation\", c(\"None\", \"char\"))\n                          ),\n                          \n                          mainPanel(\n                            plotOutput('plot'))\n                          )),\n                 tabPanel(\"기간별 걸음수\",\n                          pageWithSidebar\n                          (\n                          headerPanel(\"기간별 평균 걸음수 비교\"),\n                          \n                          sidebarPanel(\n                            selectInput(\"month1\", \"select month\", choices=c(\"month1\",  \"month2\",  \"month3\",  \"month4\",  \"month5\",  \"month6\",  \"month7\",  \"month8\",  \"month9\",  \"month10\", \"month11\", \"month12\")),\n                            selectInput(\"month2\", \"select month2\", choices=c(\"month1\",  \"month2\",  \"month3\",  \"month4\",  \"month5\",  \"month6\",  \"month7\",  \"month8\",  \"month9\",  \"month10\", \"month11\", \"month12\"))\n                          ),\n                          \n                          mainPanel(\n                            plotOutput('plot2'))\n                          )),\n                 tabPanel(\"개인 걸음수\",\n                          pageWithSidebar\n                          (\n                          headerPanel(\"기간별 개인 걸음수 비\"),\n                          \n                          sidebarPanel(\n                            selectInput(\"month3\", \"select month\", choices=c(\"month1\",  \"month2\",  \"month3\",  \"month4\",  \"month5\",  \"month6\",  \"month7\",  \"month8\",  \"month9\",  \"month10\", \"month11\", \"month12\")),\n                            selectInput(\"month4\", \"select month\", choices=c(\"month1\",  \"month2\",  \"month3\",  \"month4\",  \"month5\",  \"month6\",  \"month7\",  \"month8\",  \"month9\",  \"month10\", \"month11\", \"month12\")),\n                            selectInput(\"names\", \"Name : \", choices=c(\"None\", dat$name))\n                          ),\n                          \n                          \n                          mainPanel(\n                            plotOutput('plot3'))\n                          ))\n  )\n  shinyApp(ui=ui, server=server)\n}",
    "created" : 1438854276494.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "723831353",
    "id" : "FA82AE5D",
    "lastKnownWriteTime" : 1438854956,
    "path" : "~/yejink/R/asdf.R",
    "project_path" : "R/asdf.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}